\documentclass[12pt]{article}
\usepackage[a4paper,margin=1in]{geometry}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{parskip}

\include{../../preamble.tex}

\begin{document}

\begin{center}
    \Large\textbf{Math 418/544 — Assignment 2}\\[0.2cm]
    \large September 15, 2025 \\[0.3cm]
    \textbf{Dr. J. Hermon}
\end{center}

\vspace{0.5cm}

\noindent\textbf{Name: Dominic Klukas} \\[0.2cm]
\textbf{Student Number: 64348378} \\

\noindent\textbf{Instructions:} This assignment is due in Canvas at 9:59 a.m. on Monday, September 22. Late assignments are not accepted.

\vspace{0.5cm}

\begin{enumerate}
    %------------------- Q1 ------------------------
    \item \textbf{(Hat Problem)}  
    Suppose \(n\) people remove their hats, mix them up, and then each chooses a hat uniformly at random. 
    Find the probability \(p_n\) that nobody chooses their own hat, and show that \(\lim_{n \to \infty} p_n = e^{-1}\).

    \textit{Hint: Let \(E_i\) denote the event that the \(i\)-th person selects their own hat, and apply the inclusion-exclusion principle given in Exercise 4.5.7.}

    \vspace{0.5cm}

    % --- Your answer here ---
    \textbf{Solution:}
    Let $A_{i}$ denote the event that the $i$-th person selects their hat. Then, the probability that nobody chooses their own hat is given by $P\left( \bigcap_{i=1}^{n} A_{i}^{c} \right) $.
    First, we observe that $P(A_i) = \frac{1}{n}$, since the hats are chosen randomly (so that each sequence of hats have the same probability of ocurring\ldots by symmetry, the number of sequences where person $i$ has hat $n$ is the same as the number of sequences where person $i$ has hat $j$ for any $1 \le  j < n$).
    Likewise, symmetry bears witness to the fact that $P(A_{i_1} \cap \ldots \cap A_{i_k}) = \frac{(n-k)!}{n!}$.
    This is because, after the $i_{k-1}$th person has chosen his hat, there remain $n-k$ hats left to choose from, and the one remaining hat must be chosen to be the $i_{k}$th person's hat. After that, there are $(n-k)!$ possible sequences for the remaining hats, out of the $n!$ total possible sequences, giving us the probability $\frac{(n-k)!}{n!}$.
    Now, the inclusion-exclusion principle tells us that the probability that a single person gets the right hat, is then:
    \begin{align*}
        P\left( \bigcup_{i=1}^{n} A_{i} \right) &= \sum_{i = 1}^{n} P(A_i) - \sum_{1 \le  i_{1} < i_{2} \le  n} P(A_{i_1} \cap A_{i_2})\\
                                          & \,+ (-1)^{n-1} \sum_{1 \le i_1 < \ldots < i_{n - 1} \le  n} P(A_{i_1} \cap \ldots \cap A_{i_{n-1}}) +(-1)^{n} P\left( \bigcap_{i=1}^{n}A_{i} \right) \\
                                          &= \sum_{i = 1}^{n} \frac{1}{n} - \sum_{1 \le  i_{1} < i_{2} \le  n} \frac{1}{n(n-1)} \\
                                          & \,+ (-1)^{n-1} \sum_{1 \le i_1 < \ldots < i_{n - 1} \le  n} \frac{1}{n!} +(-1)^{n} \frac{1}{n!}
    .\end{align*}
    First, we observe that the terms that are being summed are constant: independent of the indices of the sums.
    Next, we can see that the number of terms in each sum are given by $\binom{n}{k}$, where k is the number of indices in the sum.
    Indeed, if there are $k$ indices, none of the indices can match (so their values are sampled from $n$ without repetition), and since their ordering is fixed, we count each "choice" only once. This describes $\binom{n}{k}$ precisely.

    Thus,
    \begin{align*}
        P\left( \bigcup_{i = 1}^{n} A_{i} \right) &= \sum_{k=1}^{n} (-1)^{k+1} \binom{n}{k} \frac{(n-k)!}{n!}\\
                                                  &= \sum_{k=1}^{n} \frac{(-1)^{k+1}}{k!}
    .\end{align*}

    However, what we really need is $1 - P \left( \bigcup_{i=1}^{n} A_{i} \right) = P\left( \bigcap_{i=1}^{n} A_{i}^{c} \right) $.
    We compute:
    \[
    p_n = 1 - P\left( \bigcup_{i = 1}^{n} A_{i} \right) = 1 - \sum_{k=1}^{n} \frac{(-1)^{k+1}}{k!} = \sum_{k = 0}^{n} \frac{(-1)^{k}}{k!}
    .\] 
    Then, $\lim_{n \to \infty}p_n = \lim_{n \to \infty} \sum_{k=0}^{n} \frac{(-1)^{k}}{k!} = e^{-1}$.

    \vspace{1cm}

    %------------------- Q2 ------------------------
    \item \textbf{(Borel \(\sigma\)-algebra)}  
    The Borel \(\sigma\)-algebra \(\mathcal{B}\) on \(\mathbb{R}\) is by definition the \(\sigma\)-algebra generated by the open subsets of \(\mathbb{R}\).
    Prove that the \(\sigma\)-algebra generated by the rational open intervals 
    \(\{(a,b) \subset \mathbb{R} \mid a,b \in \mathbb{Q}\}\) is the same as \(\mathcal{B}\).

    \vspace{0.5cm}

    \textbf{Solution:}
    A basic result concerning sigma algebras is that $\sigma(A) = \sigma(B)$ if $A \subset  \sigma(B)$ and $B \subset  \sigma(A)$.

    In this case, denote $A = \{(a, b) \subset  \R | a, b \in \Q\} $, and $B$ the set of open subsets of $\R$.
    Clearly, $A \subset B \subset \sigma(B)$.
    So, to show that $\sigma(A) = \sigma(B)$, we need only show that for any $B \subset  \sigma(A)$.

    To show this, let $X \in B$.
    Then, let
    \[
        C = \bigcup_{\substack{Y \in \sigma(A) \\ Y \subset X}} Y
    .\] 
    This is a countable union, since the rational open intervals can be enumerated as $|\Q \times  \Q|$ is countable. Since it is a countable union of rational open intervals, $C \in \sigma(A)$.
    By construction, $C \subset X$, since for any $x \in C$, $x \in Y$ for some $Y \in A$ such that $Y \subset  X$.
    Now, suppose $x \in X$.
    Then, there exists some open ball $B(x, r) \subset  X$ where $r > 0$.
    But then, by density of rationals there exists $q_1, q_2 \in \Q$ $x - r < q_1 < x < q_2 < x + r $, so that $(q_1, q_2) \subset  B(x, r) \subset  X$.
    Since $(q_1, q_2)$ is a rational open interval, $(q_1, q_2) \in A$.
    Thus, $(q_1, q_2)$ is in the union defining $C$, and so $(q_1, q_2) \subset  C$.
    Therefore, $x \in C$, so $X \subset  C$ and then $X = C$.

    Since $X $ was arbitrary, $B \subset  \sigma(A)$.
    Therefore, $\sigma(B) = \sigma(A)$, in other words the sigma algebra generated by the set of rational open intervals is the Borel $\sigma$-algebra on $\R$.

    \vspace{1cm}

    %------------------- Q3 ------------------------
    \item \textbf{Rosenthal 2.7.5.}
    Suppose that $\Omega=\mathbb{N}$ is the set of positive integers, and $\mathcal{F}$ is the set of all subsets $A$ such that either $A$ or $A^{c}$ is finite, and $P$ is defined by $P(A)=0$ if $A$ is finite, and $P(A)=1$ if $A^{c}$ is finite.
    \begin{enumerate}
        \item[(a)] Is $\mathcal{F}$ an algebra?
        \item[(b)] Is $\mathcal{F}$ a $\sigma$-algebra?
        \item[(c)] Is $P$ finitely additive?
        \item[(d)] Is $P$ countably additive on $\mathcal{F}$, meaning that if $A_1,A_2,\ldots\in\mathcal{F}$ are disjoint, and if it happens that $\bigcup_{n} A_n\in\mathcal{F}$, then $P\!\left(\bigcup_{n} A_n\right)=\sum_{n}P(A_n)$?
    \end{enumerate}

    \vspace{0.5cm}

    \textbf{Solution:}
    
    \begin{enumerate}
        \item Yes. We check the requirements for $\mathcal{F}$ to be an algebra.
            \begin{itemize}
                \item $\emptyset, \Omega \in \mathcal{F}$. $\emptyset$ is finite, and $\Omega^{c} = \emptyset$. Therefore $\emptyset, \Omega \in \mathcal{F}$.
                \item Closed under complements: Suppose $A \in \mathcal{F}$. Then, one of $A$ or $A^{c}$ is finite, so one of $A^{c}$ or $(A^{c})^{c} = A$ is finite, so $A \in \mathcal{F}$.
                \item Closed under finite unions. Let $A_1, \ldots, A_n \in \mathcal{F}$, and denote $A = \bigcup_{i = 1}^{n} A_i$.
                    If all of $A_1, \ldots, A_n$ are finite, then $A = \bigcup_{i = 1}^{n} A_i$ is finite, so $A^{c}$ is infinite an d $A \in \mathcal{F}$.
                    Now suppose any of $A_i$ are infinite, and $A_i^{c}$ is finite.
                    Let $L = \max \{m \in A_{i}^{c}\} $.
                    Then, for all $m > L$, $m \in A_i \subset A$.
                    However, then $A^{c} \subset \{m \in \N | m \le  L\} $, which is finite.
                    Therefore, $A \in \mathcal{F}$.
            \end{itemize}
            Therefore, $\mathcal{F}$ is an algebra.
        \item $\mathcal{F}$ is not a $\sigma$-algebra, because it is not countable additive.
            Consider the sets $\{2n\}$, where $n \in \N$.
            For each of these sets, $\N \setminus \{2n\}$ is infinite, so they are in $\mathcal{F}$.
            However, consider $A = \bigcup_{n = 1}^{\infty} \{2n\} = \{2n | n \in \N\} $ (the even numbers).
            Then, $A^{c} = \{2n - 1 | n \in \N\}$ (the odd numbers).
            However, both of these sets are infinite, so $A \not\in  \mathcal{F}$.
            Therefore, $\mathcal{F}$ is not closed under countable unions, so it is not a $\sigma$-algebra.
        \item Yes. Let $A_1, \ldots, A_{n}$ be disjoint.
            First, we claim that at most 1 of these sets can be infinite and in $\mathcal{F}$.
            Suppose not. Then, $A_i \cap A_j \neq \emptyset$, and both are infinite.
            However, both $A_i^{c}$ and $A_{j}^{c}$ are finite.
            Let $M_1 = \max A_i^{c}$, and $M_2 = \max A_{j}^{c}$.
            Then, this implies that $n > M_1 \implies n \in A_i$ and $n > M_2 \implies n \in A_j$, so that for instance $M_1 + M_2 + 1 \in A_i \cap A_j$, so that we arrive at a contradiction.

            Now, if all $A_1, \ldots, A_n$ are finite, then their disjoint union is finite, and we have
            \[
            P(\bigcup_{i = 1}^{n} A_i)  = 0 = \sum_{i = 1}^{n} 0 = \sum_{i = 1}^{n} A_i
            .\] 

            If one of $A_{1}, \ldots, A_n$ is infinite, then all the others are finite, and their union is infinite. Take $i$ to be the index of the infinite set.
            Then, we have
            \[
            P(\bigcup_{i = 1}^{n} A_i) = 1 = \sum_{j \neq i} 0 + 1 = \sum_{j \neq i} P(A_j) + P(A_i) = \sum_{j = 1}^{n} P(A_j)
            .\] 
        \item No, $P$ is not countably additive on $\mathcal{F}$.
            We know that the sets $\{n\} $ for $n \in \mathcal{N}$ are disjoint, and each is finite and in $\mathcal{F}$.
            However,
            \[
            P(\bigcup_{n = 1}^{\infty} \{n\} ) = P(\N) =  1 \neq 0 = \sum_{n = 1}^{\infty} P(\{n\} ) = \sum_{n=1}^{\infty} 0
            .\] 
    \end{enumerate}

    \vspace{1cm}

    %------------------- Q4 ------------------------
    \item \textbf{Rosenthal 2.7.9.}
    Let $\mathcal{F}$ be a $\sigma$-algebra, and write $\lvert \mathcal{F}\rvert$ for the total number of subsets in $\mathcal{F}$. Prove that if $\lvert \mathcal{F}\rvert<\infty$ (i.e., if $\mathcal{F}$ consists of just a finite number of subsets), then $\lvert \mathcal{F}\rvert=2^{m}$ for some $m\in\mathbb{N}$. 
    [Hint: Consider those non-empty subsets in $\mathcal{F}$  which do not contain any other non-empty subset in $\mathcal{F}$. How can all subsets in $\mathcal{F}$ be ``built up'' from these particular subsets?]

    \vspace{0.5cm}

    \textbf{Solution:}
    We follow the hint.
    Let
    \[
    S = \{A \in \mathcal{F} | \forall B \in \mathcal{F}, A \cap B \in \{A, \emptyset\}, A \neq \emptyset  \} 
    .\] 
    Since $\mathcal{F}$ is finite, we must have that $S$ is finite as well.
    Now, consider $\mathcal{P}(S)$.
    Since it is a power set, we have that it has $2^{n}$ elements, where $n = |S|$.

    We will show that the function $f : \mathcal{P}(S) \to \mathcal{F}$ defined by $f(X) = \bigcup_{A \in X} A$ is a bijection, which will show that $|\mathcal{F}|$.
    \begin{itemize}
        \item First, we note that this function is well defined: since, for any $X \in \mathcal{P}(S)$, the elements $A \in X$ are in $\mathcal{F}$, and $\mathcal{F}$ is closed under countable unions, it follows that $f(X) = \bigcup_{A \in X} A \in \mathcal{F}$.
        \item Now, to show that $f$ is a bijection, we need only show that it is injective, since $\mathcal{F}$ and $\mathcal{P}(S)$ are finite sets.
            Let $X, Y \in \mathcal{P}(S)$.
            Suppose $f(X) = \bigcup_{A \in X} A = \bigcup_{B \in Y} B = f(Y)$.
            If $f(X) = \emptyset$, then $X = Y = \emptyset$, since no $A \in S$ is the empty set.
            Thus, suppose not. Then, there exists some $x \in \Omega$ such that $x \in f(X)$.
            Then, there exists some $A \in X$ such that $x \in A$, and $B \in Y$ such that $x \in B$, with $A, B \in S$.
            However, by the definition of $S$, this implies that $A = B$.

            Next, we show that
            \[
            f(X \setminus \{A\} ) = \bigcup_{A' \in (X \setminus \{A\} )} A' = \left(\bigcup_{A' \in X} A'\right) \setminus A
            .\] 
            Suppose $x \in f(X \setminus \{A\})$.
            If $x\in A$, then we must have that $x \in A'$ for some $A' \in X \setminus \{A\} $.
            However, the definition of $S$ gives us that $A' = A$ since the sets in $S$ are pairwise disjoint, so we arrive at a contradiction.
            Therefore, $x \not\in A$.
            Also, $x \in A'$ for some $A' \in X$.
            Therefore, $x \in \left( \bigcup_{A' \in X} A' \right) \setminus A $.
            Now, suppose $x \in \left( \bigcup_{A' \in X} A' \right) \setminus A $.
            Then, $x \in A'$ for some $A' \in X$, and $x \not\in A$, so $A' \neq A$.
            Thus, $x \in f(X \setminus \{A\} )$.

            Therefore, we can apply this result to see:
            \[
            f(X \setminus \{A\} ) = (\cup_{A' \in X} A') \setminus A = (\cup_{B' \in Y} B') \setminus B = f(Y \setminus \{B\} )
            .\] 

            But then, we can apply this procedure, to remove another set, $A_1$ from $X$, and get some $B_1 = A_1$ such that
            \[
            f(X \setminus \{A, A_1\} ) = (X \setminus A) \setminus A_1 = (X \setminus B) \setminus B_1 = f(Y \setminus \{B, B_1\} )
            .\] 
            Since there are finitely many sets in $X$, we will eventually get that $f(X \setminus \{A_i\}_{i} ) = f(\emptyset) = \emptyset = f(Y \setminus \{A_i\}_{i} )$.
            However, this implies that $Y \setminus \{A_i\}_i = \emptyset $.
            Thus, $Y \subset X = \{A_i\}_i $.
            However, WLOG, we can also show that $X \subset Y$.
            Therefore, $X = Y$ and $f$ is injective.
            Thus, $\mathcal{F} = \mathcal{P}(S)$, and so has cardinality $2^{m}$, as desired.
    \end{itemize}

    \vspace{1cm}

    %------------------- Q5 ------------------------
    \item \textbf{Rosenthal 2.7.21.}
    Let $\lambda$ be Lebesgue measure in dimension two, i.e.\ Lebesgue measure on $[0,1]\times[0,1]$. Let 
    \[
    A=\{(x,y)\in[0,1]\times[0,1]:\ y<x\}.
    \]
    Prove that $A$ is measurable with respect to $\lambda$, and compute $\lambda(A)$.

    \textit{For the computation of \(\lambda(A)\), you may find Proposition 3.3.1 to be useful.}

    \vspace{0.5cm}

    \textbf{Solution:}

    Consider the following sets:
    \[
    A_{n} = \bigcup_{i = 0}^{2^{n}-1} (i 2^{-n}, (i + 1) 2^{-n}] \times  [0, i 2^{-n})
    .\] 
    Intuitively, this consists of the Riemann rectangles below the graph of $y = x$, with rectangle width $\frac{1}{2^{n}}$.
    The idea here:
    \begin{itemize}
        \item each of these is a disjoint union of sets we know are Lebesgue measurable (rectangles of half-open intervals) whose measure we know
        \item $A_n \subset  A_{n+1}$ so that we can compute $\lim_{n \to \infty} \lambda(A_n) = \lambda \left( \bigcup_{n=1}^{\infty} A_n \right)  $
        \item and last (but definitely not least) $A = \bigcup_{n=1}^{\infty}A_n$. Each of these claims we will check in turn.
    \end{itemize}
    Let us begin with the proofs of these statements.
    \begin{itemize}
        \item To see that $A_n$ is a disjoint union, suppose WLOG that $i < j$. Then, for $(x_1, x_2) \in (i 2^{-n}, (i + 1) 2^{-n}] \times  [0, i 2^{-n})$ and $(y_1, y_2) \in (j 2^{-n}, (j + 1) 2^{-n}] \times  [0, j 2^{-n})$ we have $i 2^{-n} <  x_1 \le  (i + 1) 2^{-n} \le   j 2^{-n} <  y_1 \le  (j + 1) 2^{-n}$.
            In particular, $x_1 \neq y_1$, so we can be usre that $(x_1, x_2) \neq (y_1, y_2)$, and these two rectangles are disjoint. Since this holds for any pair $i, j$ with $i \neq j$, all of the rectangles are pairwise disjoint.
        \item Next, we show that $A_{n} \subset  A_{n+1}$.
            Let $x \in A_n$.
            There exists some $0 \le  i < 2^{n}$ such that $x \in (i 2^{-n}, (i + 1) 2^{-n}] \times  [0, i 2^{-n})$.
            We compute that:
            \begin{align*}
                & \, (i 2^{-n}, (i + 1) 2^{-n}] \times  [0, i 2^{-n})\\
                &\subseteq  (((2i) 2^{-(n+1)}, (2i + 1) 2^{-(n+1)}] \times [0, (2i) 2^{-(n+1)}))\cup\\
                & \quad (((2i + 1) 2^{-(n+1)}, ((2i+1) + 1)2^{-(n+1)}]\times  [0, (2i + 1) 2^{-(n+1)}))
            .\end{align*}
            $0 \le  i < 2^{n}$ implies $0 \le  2i < 2i + 1 < 2^{n + 1}$.
            Therefore, both of these rectangles in this last line are in $A_{n+1}$, so this set inclusion implies $x \in A_{n+1}$.
            Thus, we have that $A_n \subset  A_{n+1}$.
        \item Next, we check that $A = \bigcup_{n = 1}^{\infty} A_n$.
            Suppose $(x, y) \in [0, 1] \times  [0, 1]$ and $y < x$.
            Then, there exists some $n$ such that $y < x - 2^{-n}$.
            Since $(i 2^{-n}, (i + 1)2^{-n}]$, $0 \le  i < 2^{n}$ is a partition of $(0, 1]$, there exists some $i$ such that $x \in (i 2^{-n}, (i + 1)2^{-n}]$. We cannot have $x = 0$, since then there is no way for $y < x$ since $y \ge  0$.
            But since $y < x - 2^{-n}$, the interval $x$ sits inside implies $y < x - 2^{-n} < (i + 1) 2^{-n} - 2^{-n} = i 2^{-n}$.
            Also, $y \ge  0$ since $y \in [0, 1]$, so $y \in [0, i 2^{-n})$.
            Therefore, $(x, y) \in (i 2^{-n}, (i + 1) 2^{-n}] \times [0, i 2^{-n})  \subset  A_n$.
            Since this applies for all $(x, y) \in A$, we have $A \subset  \bigcup_{n = 1}^{\infty}$.
        \item Finally, we compute $\lambda(A)$.
            First, we compute:
            \begin{align*}
                \lambda(A_n) = \sum_{i = 0}^{2^{n} - 1} ((i + 1) 2^{-n} - i 2^{-n})(i 2^{-n})= \sum_{i = 0}^{2^{n} - 1} i \cdot  2^{-n} \cdot  2^{-n} &= (2^{-2n}) \cdot  \frac{2^{n}(2^{n} - 1)}{2}\\ 
                                                                                                                                                      &= \frac{1}{2} - \frac{1}{2^{n + 1}}
            .\end{align*}
            We have:
            \begin{align*}
                \lambda(A) &= \lambda \left(  \bigcup_n A_n \right) = \lim_{n \to \infty} \lambda(A_n)\\
                &= \lim_{n \to \infty}  \frac{1}{2} - \frac{1}{2^{n+1}} = \frac{1}{2}
            .\end{align*}
    \end{itemize}
    Therefore, $A$ is lebesgue measurable, and has measure $\frac{1}{2}$.

\end{enumerate}

\vspace{1.5cm}

\noindent\textbf{Recommended (not to be handed in):}  
2.7.7, 2.7.14, 2.7.15, 2.7.19, 2.7.22.  
For solutions to even-numbered problems see: \\
\texttt{http://www.probability.ca/jeff/grprobbook.html}

\vfill

\begin{center}
    \textit{"It is seen in this essay that the theory of probabilities is at bottom only common sense reduced to calculus; ..."}\\
    — Pierre Simon Laplace, \textit{A Philosophical Essay on Probabilities}
\end{center}

\end{document}
